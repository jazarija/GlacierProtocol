# Glacier
Glacier is a protocol for secure cold storage of bitcoins.
[https://www.glacierprotocol.org](https://www.glacierprotocol.org)

This is BitcoinHodler's fork of the [canonical
repo](https://github.com/GlacierProtocol/GlacierProtocol) and contains
the following branches, most of which I plan to (eventually) submit as
Pull Requests:

## Awaiting review & merge

* python3: switches python version to modern. [PR
  #61](https://github.com/GlacierProtocol/GlacierProtocol/pull/61)

* p2wsh (built on python3): add `--p2wsh` flag to create native segwit
  deposit addresses. [PR
  #76](https://github.com/GlacierProtocol/GlacierProtocol/pull/76)

* validate-keys (built on p2wsh): make sure if user provides more
  keys than needed, they are really the correct keys for this
  wallet. [PR
  #73](https://github.com/GlacierProtocol/GlacierProtocol/pull/73)

  * Ensure if user enters address that doesn't correspond to redeem
    script, we don't freak out. Issue
    [#57](https://github.com/GlacierProtocol/GlacierProtocol/issues/57)

  * Add a test for extra keys using both legacy and segwit. Issue
    [#20](https://github.com/GlacierProtocol/GlacierProtocol/issues/20)

## Ready for upstreaming

* dup-input (built on validate-keys): Ensure if user enters same input
  transaction twice, we don't quietly generate an invalid withdrawal
  transaction. Issue
  [#75](https://github.com/GlacierProtocol/GlacierProtocol/issues/75)

* fix-fee (built on dup-input): correct transaction fee when no change made.
  Issue [#19](https://github.com/GlacierProtocol/GlacierProtocol/issues/19)

  * Also contains some major refactoring to make the actual fix easy.

* no-floats (built on fix-fee): avoid any floating point for BTC values

* tidypy (built on no-floats): clean up source code using linters from
  [TidyPy](https://pypi.org/project/tidypy/)

  * Run `tidypy check` to run linter

  * Also enabled coverage; run `make COVERAGE=1; firefox
    coverage-report/index.html`

  * Added several new tests to plug coverage holes

  * Still several lint failures; I'm not sure of the best way to fix
    them

* regtest (built on tidypy): switch developer tests from testnet to
  regtest

  * This is a necessary precursor to using PSBT, since the developer
    tests will need an "online" node to construct and validate the
    withdrawal transactions

  * Allows us to validate all withdrawal transactions generated by
    GlacierScript as an automated part of the developer tests.

* subparsers (built on regtest): use python argparse's subparsers
  ([#63](https://github.com/GlacierProtocol/GlacierProtocol/issues/63))

## In progress

* psbt (built on subparsers): adding PSBT withdrawal support

## Experiments

* psbt.old: experimenting with
  [PSBT](https://github.com/bitcoin/bitcoin/blob/master/doc/psbt.md)
  for transaction construction and signing; also see
  [glacier-psbt](https://github.com/bitcoinhodler/glacier-psbt)

## Future

I plan to script a PSBT flow for use with an online full node, but
this really deserves proper wallet software support. I would like to
partner with an existing desktop or mobile wallet to handle Glacier
storage as watch-only addresses, and generate the withdrawal PSBTs for
offline signing using the protocol.

Once that's in place, I'd like to upgrade the system to use HDM
(hierarchical deterministic multisig), a simplified form of
[BIP45](https://github.com/bitcoin/bips/blob/master/bip-0045.mediawiki),
to put an end to the current address reuse. With HDM, every deposit
will be to a unique address, and every one of those deposits can be
withdrawn using the same M-of-N set of master keys. PSBT can already
handle this nicely, though we will need to generate receiving
addresses using the quarantined laptops.

This creates new dangers of obsolescence, unfortunately. If this
wallet software isn't maintained, it might be very difficult to
withdraw Glacier-stored coins in the distant future. We already have
enough trouble maintaining the current Glacier.
